<!DOCTYPE html>
<html lang="zh-CN" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>部署自己的日记系统 | 我的文档</title>
    <meta name="description" content="HA!">
    <meta name="generator" content="VitePress v1.6.4">
    <link rel="preload stylesheet" href="/readme/assets/style.BFcwSnoj.css" as="style">
    <link rel="preload stylesheet" href="/readme/vp-icons.css" as="style">
    
    <script type="module" src="/readme/assets/app.BLpoqB9v.js"></script>
    <link rel="preload" href="/readme/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/readme/assets/chunks/theme.-arRWIY8.js">
    <link rel="modulepreload" href="/readme/assets/chunks/framework.BjE8olX4.js">
    <link rel="modulepreload" href="/readme/assets/diary_部署说明.md.DsGsnEmT.lean.js">
    <link rel="icon" href="/favicon.ico">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-d8b57b2d><!--[--><!--]--><!--[--><span tabindex="-1" data-v-fcbfc0e0></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-fcbfc0e0>Skip to content</a><!--]--><!----><header class="VPNav" data-v-d8b57b2d data-v-7ad780c2><div class="VPNavBar" data-v-7ad780c2 data-v-9fd4d1dd><div class="wrapper" data-v-9fd4d1dd><div class="container" data-v-9fd4d1dd><div class="title" data-v-9fd4d1dd><div class="VPNavBarTitle has-sidebar" data-v-9fd4d1dd data-v-9f43907a><a class="title" href="/readme/" data-v-9f43907a><!--[--><!--]--><!----><span data-v-9f43907a>我的文档</span><!--[--><!--]--></a></div></div><div class="content" data-v-9fd4d1dd><div class="content-body" data-v-9fd4d1dd><!--[--><!--]--><div class="VPNavBarSearch search" data-v-9fd4d1dd><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-9fd4d1dd data-v-afb2845e><span id="main-nav-aria-label" class="visually-hidden" data-v-afb2845e> Main Navigation </span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/readme/" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>主页</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/readme/diary/%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>日记</span><!--]--></a><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/readme/v2ray/v2ray%20%E5%AE%A2%E6%88%B7%E7%AB%AF%20Linux.html" tabindex="0" data-v-afb2845e data-v-815115f5><!--[--><span data-v-815115f5>V2ray</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-9fd4d1dd data-v-3f90c1a5><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-3f90c1a5 data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-9fd4d1dd data-v-ef6192dc data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-9fd4d1dd data-v-f953d92f data-v-bfe7971f><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-bfe7971f><span class="vpi-more-horizontal icon" data-v-bfe7971f></span></button><div class="menu" data-v-bfe7971f><div class="VPMenu" data-v-bfe7971f data-v-20ed86d6><!----><!--[--><!--[--><!----><div class="group" data-v-f953d92f><div class="item appearance" data-v-f953d92f><p class="label" data-v-f953d92f>Appearance</p><div class="appearance-action" data-v-f953d92f><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-f953d92f data-v-be9742d9 data-v-b4ccac88><span class="check" data-v-b4ccac88><span class="icon" data-v-b4ccac88><!--[--><span class="vpi-sun sun" data-v-be9742d9></span><span class="vpi-moon moon" data-v-be9742d9></span><!--]--></span></span></button></div></div></div><div class="group" data-v-f953d92f><div class="item social-links" data-v-f953d92f><div class="VPSocialLinks social-links-list" data-v-f953d92f data-v-e71e869c><!--[--><a class="VPSocialLink no-icon" href="https://github.com/vuejs/vitepress" aria-label="github" target="_blank" rel="noopener" data-v-e71e869c data-v-60a9a2d3><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-9fd4d1dd data-v-6bee1efd><span class="container" data-v-6bee1efd><span class="top" data-v-6bee1efd></span><span class="middle" data-v-6bee1efd></span><span class="bottom" data-v-6bee1efd></span></span></button></div></div></div></div><div class="divider" data-v-9fd4d1dd><div class="divider-line" data-v-9fd4d1dd></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-d8b57b2d data-v-2488c25a><div class="container" data-v-2488c25a><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-2488c25a><span class="vpi-align-left menu-icon" data-v-2488c25a></span><span class="menu-text" data-v-2488c25a>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-2488c25a data-v-6b867909><button data-v-6b867909>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-d8b57b2d data-v-42c4c606><div class="curtain" data-v-42c4c606></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-42c4c606><span class="visually-hidden" id="sidebar-aria-label" data-v-42c4c606> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0 has-active" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>1. 标题日记</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E9%A1%B9%E7%9B%AE%E4%BB%8B%E7%BB%8D.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>项目介绍</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E8%B4%A6%E5%8D%95%E4%BD%BF%E7%94%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>账单使用</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E5%85%B1%E4%BA%AB%E6%97%A5%E8%AE%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>共享日记</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E4%B8%8D%E6%98%8E%E6%98%BE%E7%9A%84%E4%B8%80%E4%BA%9B%E5%8A%9F%E8%83%BD.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>不明显的一些功能</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E6%97%A5%E8%AE%B0%E6%98%BE%E7%A4%BA.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>日记显示</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E5%BE%85%E5%8A%9E%E5%88%97%E8%A1%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>待办列表</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E9%93%B6%E8%A1%8C%E5%8D%A1%E5%88%97%E8%A1%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>银行卡列表</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E6%97%A5%E5%8E%86%E7%BF%BB%E9%98%85%E6%97%A5%E8%AE%B0.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>日历翻阅日记</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E9%83%A8%E7%BD%B2%E8%AF%B4%E6%98%8E.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>部署说明</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/diary/%E9%A1%B9%E7%9B%AE%E6%88%AA%E5%9B%BE.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>项目截图</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>2. v2ray</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/v2ray/v2ray%20%E5%AE%A2%E6%88%B7%E7%AB%AF%20Linux.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>v2ray 客户端 Linux</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/v2ray/v2ray%20%E5%AE%A2%E6%88%B7%E7%AB%AF%20macOS.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>v2ray 客户端 macOS</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/v2ray/v2ray%20%E5%AE%A2%E6%88%B7%E7%AB%AF%20Windows.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>v2ray 客户端 Windows</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/v2ray/v2ray%20%E6%9C%8D%E5%8A%A1%E5%99%A8%E9%85%8D%E7%BD%AE.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>v2ray 服务器配置</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/v2ray/v2ray%20%E8%B0%B7%E6%AD%8C%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8F%92%E4%BB%B6%E4%BD%BF%E7%94%A8.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>v2ray 谷歌浏览器插件使用</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>3. 五笔码表助手</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/wubiDictEditor/%E4%BA%94%E7%AC%94%E7%A0%81%E8%A1%A8%E5%8A%A9%E6%89%8B%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>五笔码表助手</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/wubiDictEditor/tool.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>码表处理工具</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><div class="no-transition group" data-v-51288d80><section class="VPSidebarItem level-0" data-v-51288d80 data-v-0009425e><div class="item" role="button" tabindex="0" data-v-0009425e><div class="indicator" data-v-0009425e></div><h2 class="text" data-v-0009425e>〇、预设</h2><!----></div><div class="items" data-v-0009425e><!--[--><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/preset/markdown-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>Markdown 例子</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-1 is-link" data-v-0009425e data-v-0009425e><div class="item" data-v-0009425e><div class="indicator" data-v-0009425e></div><a class="VPLink link link" href="/readme/preset/api-examples.html" data-v-0009425e><!--[--><p class="text" data-v-0009425e>API 例子</p><!--]--></a><!----></div><!----></div><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-d8b57b2d data-v-9a6c75ad><div class="VPDoc has-sidebar has-aside" data-v-9a6c75ad data-v-e6f2a212><!--[--><!--]--><div class="container" data-v-e6f2a212><div class="aside" data-v-e6f2a212><div class="aside-curtain" data-v-e6f2a212></div><div class="aside-container" data-v-e6f2a212><div class="aside-content" data-v-e6f2a212><div class="VPDocAside" data-v-e6f2a212 data-v-cb998dce><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-cb998dce data-v-f610f197><div class="content" data-v-f610f197><div class="outline-marker" data-v-f610f197></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-f610f197>On this page</div><ul class="VPDocOutlineItem root" data-v-f610f197 data-v-53c99d69><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-cb998dce></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-e6f2a212><div class="content-container" data-v-e6f2a212><!--[--><!--]--><main class="main" data-v-e6f2a212><div style="position:relative;" class="vp-doc _readme_diary_%E9%83%A8%E7%BD%B2%E8%AF%B4%E6%98%8E" data-v-e6f2a212><div><h1 id="部署自己的日记系统" tabindex="-1">部署自己的日记系统 <a class="header-anchor" href="#部署自己的日记系统" aria-label="Permalink to &quot;部署自己的日记系统&quot;">​</a></h1><p>前后端完全开源，你可以部署一套自己的日记系统。</p><blockquote><p>不过最好你已经具备 linux 服务器的操作能力，会安装指定程序，修改服务配置等。如果你不了解，最好还是直接用现成的。学习起来可能需要点时间。</p></blockquote><p>该项目包含两个部分：</p><ul><li>前端：<a href="https://github.com/KyleBing/diary-vue" target="_blank" rel="noreferrer">https://github.com/KyleBing/diary-vue</a> <code>vue3</code>、<code>ts</code>、<code>vite</code></li><li>后台：<a href="https://github.com/KyleBing/portal" target="_blank" rel="noreferrer">https://github.com/KyleBing/portal</a> <code>nodejs</code></li></ul><p>默认的部署目录是这样</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ nginx 文档根目录 ]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      │</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diary</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 前端网页文件夹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> portal</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     # 后台服务文件夹</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">   </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 后台服务的真实入口</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 后台配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">    └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node_modules</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span></span></code></pre></div><h2 id="一、服务器配置需求" tabindex="-1">一、服务器配置需求 <a class="header-anchor" href="#一、服务器配置需求" aria-label="Permalink to &quot;一、服务器配置需求&quot;">​</a></h2><p>目前没有 docker 的部署方式，还没有实现，我不太会这玩意。<br> 另外不使用 docker 的方式也有个好处就是，可以在非常低配置的服务器上运行。</p><p>你的服务器只需要满足下面的需求即可，因为我的目前就是这样的：</p><ul><li>带宽 1M 即可 <blockquote><p>前端项目进行了足够好的优化，加载速度并不慢</p></blockquote></li><li>内存 1G 即可</li><li>系统最好是 <strong>Ubuntu</strong><blockquote><p>因为我的教程里会以 Ubuntu 为准，当然其它系统也可以实现，只是有些地方会有不同，比如 nginx 的配置目录结构会有不同。</p></blockquote></li></ul><p>接下来会非常详尽的解说如何部署自己的日记系统，你只需要有基础的 linux 操作能力即可。</p><h2 id="二、运行环境搭建" tabindex="-1">二、运行环境搭建 <a class="header-anchor" href="#二、运行环境搭建" aria-label="Permalink to &quot;二、运行环境搭建&quot;">​</a></h2><p>不管是在你的电脑端，还是在服务端，都需要安装好的开发环境有：</p><ul><li><strong>git</strong> <code>开发中的版本管理工具</code></li><li><strong>nodejs</strong> v20+ <code>nodejs环境</code></li><li><strong>npm</strong> <code>nodejs 的包管理器</code></li><li><strong>yarn</strong> <code>nodejs 的包另一个管理器，我习惯用这个</code></li></ul><p>查看你的系统版本，能看出你系统具体是什么 <code>debian</code> <code>centos</code> <code>ubuntu</code></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/os-release</span></span></code></pre></div><p>比如我的返回结果就是下面，表明我系统是 <strong>Ubuntu</strong></p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@aliyun:~#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cat</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> /etc/os-release</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PRETTY_NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Ubuntu 22.04.1 LTS&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">NAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Ubuntu&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VERSION_ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;22.04&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VERSION</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;22.04.1 LTS (Jammy Jellyfish)&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">VERSION_CODENAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jammy</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">ubuntu</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">ID_LIKE</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">debian</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">HOME_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://www.ubuntu.com/&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">SUPPORT_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://help.ubuntu.com/&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">BUG_REPORT_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://bugs.launchpad.net/ubuntu/&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">PRIVACY_POLICY_URL</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;https://www.ubuntu.com/legal/terms-and-policies/privacy-policy&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">UBUNTU_CODENAME</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">jammy</span></span></code></pre></div><h3 id="_1-安装-git" tabindex="-1">1. 安装 git <a class="header-anchor" href="#_1-安装-git" aria-label="Permalink to &quot;1. 安装 git&quot;">​</a></h3><p>Linux 服务器中一般都默认安装了 git，不需要额外处理。<br> 如果你是 Windows、Mac，需要自行问<a href="https://www.doubao.com/" target="_blank" rel="noreferrer">豆包</a>如何安装，不再冗述。</p><h3 id="_2-安装-nodejs-v20" tabindex="-1">2. 安装 nodejs v20+ <a class="header-anchor" href="#_2-安装-nodejs-v20" aria-label="Permalink to &quot;2. 安装 nodejs v20+&quot;">​</a></h3><p>知道你系统是什么之后，去问<a href="https://www.doubao.com/" target="_blank" rel="noreferrer">豆包</a>，在你的系统中该如何安装 nodejs，它就会告诉你该用什么指令安装，现在(2025.11.08)默认安装的 nodejs 都是 v20+ 的。</p><p>安装完成之后，通过以下指令检查是否安装成功</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">node</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 正确安装之后，它会显示对应的 nodejs 版本号</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 像这样</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@aliyun:~#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> </span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">v20.18</span></span></code></pre></div><p>安装 nodejs 完成之后，它会默认安装 npm，所以 npm 就不用额外管了。</p><h3 id="_3-安装-yarn" tabindex="-1">3. 安装 yarn <a class="header-anchor" href="#_3-安装-yarn" aria-label="Permalink to &quot;3. 安装 yarn&quot;">​</a></h3><p><strong>yarn</strong> 是包管理器，跟 <strong>npm</strong> 一样的东西。</p><p>执行</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yarn</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 它是 npm install -g yarn 的缩写</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 它会全局安装 yarn 指令</span></span></code></pre></div><p>检查是否安装成功是一样的</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yarn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span></code></pre></div><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 比如，像我的，显示版本号就表示安装成功</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@aliyun:~#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> yarn</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -v</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">1.22.19</span></span></code></pre></div><h2 id="三、部署前端" tabindex="-1">三、部署前端 <a class="header-anchor" href="#三、部署前端" aria-label="Permalink to &quot;三、部署前端&quot;">​</a></h2><p>前端需要修改一个项目配置文件，需要一个显示在前端页面中的管理员邮箱，这个邮箱的主要作用是：当后台服务不能正常访问的时候，显示到页面中提示用户。</p><p>这个构建过程需要一定的硬件需求，如果服务器是 1G 内存的可能满足不了构建前端页面的需求。<br> 所以推荐你将前端代码下载到本地，在本地完成前端文件的构建，再上传到服务器中使用。当然，如果你服务器配置够高，可以直接在服务器上执行这些操作。</p><h3 id="_1-下载项目文件" tabindex="-1">1. 下载项目文件 <a class="header-anchor" href="#_1-下载项目文件" aria-label="Permalink to &quot;1. 下载项目文件&quot;">​</a></h3><p>终端中执行</p><div class="language-sh vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">sh</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/KyleBing/diary.git</span></span></code></pre></div><p>会将 github 中最新的前端源码下载下来，放到当前目录中名为 diary 的文件夹中。</p><h3 id="_2-安装代码所需依赖库" tabindex="-1">2. 安装代码所需依赖库 <a class="header-anchor" href="#_2-安装代码所需依赖库" aria-label="Permalink to &quot;2. 安装代码所需依赖库&quot;">​</a></h3><p>进入这个 diary 文件夹中，执行</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">yarn</span></span></code></pre></div><p>你会看到有进度条在走，等它走完会在文件夹中多出一个名为 <code>node_modules</code> 的文件夹</p><h3 id="_3-修改前端配置文件" tabindex="-1">3. 修改前端配置文件 <a class="header-anchor" href="#_3-修改前端配置文件" aria-label="Permalink to &quot;3. 修改前端配置文件&quot;">​</a></h3><p>前端的配置文件内容是这样的：</p><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;adminEmail&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kylebing@163.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 管理员账户</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;isShowDemoAccount&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 是否显示演示账户按钮</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">     // 演示账户内容，会在登录页面点击 演示账户登录时自动填写</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;demoAccount&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test@163.com&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;demoAccountPassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;test&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // [ 可选 ] 七牛云相关配置</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;QiniuImgBaseURL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;QiniuBucketName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;QiniuStyleSuffix&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // [ 可选 ] 和风天气 API KEY，用于获取天气信息</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;HefengWeatherKey&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    // 注册界面的注册提示信息，支持 HTML 格式的内容</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;registerTip&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&lt;p&gt;日记应用&lt;/p&gt;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>修改配置文件的主要目的是：</p><ul><li>定义前端页面中显示的管理员邮箱账户，当后台有问题时会显示这个信息</li><li><code>[可选]</code> 七牛云存储 key，需要搭配后台使用</li><li><code>[可选]</code> 天气数据自动获取的 api key</li></ul><h3 id="_4-构建最终页面" tabindex="-1">4. 构建最终页面 <a class="header-anchor" href="#_4-构建最终页面" aria-label="Permalink to &quot;4. 构建最终页面&quot;">​</a></h3><p>修改完配置之后，其它都不需要修改了，直接使用原库的内容就好了，这样以后再更新网页的时候也方便。</p><p>回到 diary 文件夹目录，执行下面指令生成最终的页面</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> run</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> build</span></span></code></pre></div><p>执行成功之后，会在 <code>diary/archive</code> 目录中多出一个名为 <code>diary-xxxx-xx-xx.zip</code> 的 zip 文件。</p><h3 id="_5-上传并部署前端文件到服务器" tabindex="-1">5. 上传并部署前端文件到服务器 <a class="header-anchor" href="#_5-上传并部署前端文件到服务器" aria-label="Permalink to &quot;5. 上传并部署前端文件到服务器&quot;">​</a></h3><p>将上面生成的那个 <code>diary-xxxx-xx-xx.zip</code> 文件，上传到服务器，再将其解压到 <code>web根目录/diary/</code> 目录下。就完成了。</p><blockquote><p>这个 web 根目录可以由你来决定，要么直接使用 nginx 服务的默认主目录，要么你自己选择一个位置，只要你知道主目录是哪一个就行。</p></blockquote><p>这一步是基础的服务器操作，就不细说了，不明白可以问 <a href="https://www.doubao.com/" target="_blank" rel="noreferrer">豆包</a></p><h2 id="四、部署后台服务" tabindex="-1">四、部署后台服务 <a class="header-anchor" href="#四、部署后台服务" aria-label="Permalink to &quot;四、部署后台服务&quot;">​</a></h2><p>后台部署要相对麻烦一些，大概需要这几个步骤：</p><ol><li>安装运行环境 <ul><li>安装 <code>mysql</code> 数据库</li><li>安装 <code>nodejs</code> <code>npm</code> <code>yarn</code> <code>git</code> 环境，第二章 里面的内容</li><li>安装 <code>pm2</code></li><li>安装 <code>nginx</code> <strong>网页服务软件</strong></li></ul></li><li>下载后台程序</li><li>修改后台服务配置</li><li>用 <code>pm2</code> 启动后台服务</li><li>初始化系统 <code>创建数据库表结构</code></li></ol><h3 id="_1-安装运行环境" tabindex="-1">1. 安装运行环境 <a class="header-anchor" href="#_1-安装运行环境" aria-label="Permalink to &quot;1. 安装运行环境&quot;">​</a></h3><ol><li><code>nodejs</code>、<code>npm</code>、<code>yarn</code>、<code>git</code> 的安装方式在第二章里已经写明了</li><li><code>mysql</code> 的安装和配置方式，去问 <a href="https://www.doubao.com/" target="_blank" rel="noreferrer">豆包</a>，这里只需要最终能提供出 <code>数据库用户名</code>、<code>密码</code>、<code>端口号</code> 即可，用于配置以下内容</li><li>安装 <code>nginx</code>，这个也去问 <a href="https://www.doubao.com/" target="_blank" rel="noreferrer">豆包</a> 吧，就是在服务器上装个普通程序一样。</li></ol><h3 id="_2-下载后台程序-nodejs" tabindex="-1">2. 下载后台程序 nodejs <a class="header-anchor" href="#_2-下载后台程序-nodejs" aria-label="Permalink to &quot;2. 下载后台程序 nodejs&quot;">​</a></h3><p>登录你的服务器，进入 web 主目录，终端中执行</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">git</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> clone</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> https://github.com/KyleBing/portal.git</span></span></code></pre></div><p>会在 web 目录中创建一个名为 <strong>portal</strong> 的目录，里面放置好了后台程序的所有文件。</p><p><strong>portal</strong> 的目录结构是这样的</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">web根目录/portal/</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dist</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> bin</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> config</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> cron</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> node_modules</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> public</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            │</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">   └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> stylesheets</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">            └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> src</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diary</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> dontstarve</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> entity</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> file</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> imageQiniu</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> init</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> map</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> qr</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> response</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> statistic</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> thumbsUp</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> user</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">                └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> wubi</span></span></code></pre></div><h3 id="_3-修改后台服务配置" tabindex="-1">3. 修改后台服务配置 <a class="header-anchor" href="#_3-修改后台服务配置" aria-label="Permalink to &quot;3. 修改后台服务配置&quot;">​</a></h3><p>接下来该修改一下后台服务的配置了，配置文件在这个文件夹中：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">web目录/portal/dist/config/</span></span></code></pre></div><p>内含两个文件：</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">root@aliyun:/var/www/html/portal/dist/config#</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ll</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">total</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 16</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  142</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configDatabase.json</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 数据库配置文件</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">-rw-r--r--</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> root</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  201</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> Aug</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> 16:01</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> configProject.json</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 项目配置文件</span></span></code></pre></div><ol><li>修改数据库配置文件，将你准备好的数据库用户名密码添加上就可以了。<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;host&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;localhost&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,          </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 数据库地址</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;user&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;root&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,               </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 数据库用户名</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;password&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;rootpassword&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,   </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 数据库密码</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;port&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3306</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,                 </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 数据库端口号</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;multipleStatements&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">    &quot;timezone&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li><li>修改项目配置文件，根据自己需要进行修改就可以了<div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;invitation_code&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;kylebingooOO&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,  </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 万能邀请码：不限次数的邀请码</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;year_data_start&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1991</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,            </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 数据准备从哪年开始，年份数据显示的时候将从这个开始</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;qiniu_access_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wertvweyvw54y31234123324123451245yvwe&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">  &quot;qiniu_secret_key&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;wertvweyvw54y34123411234123413415yvwe&quot;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // [ 可选 ]</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 七牛云 access_key 和 secret_key 用于与七牛云服务器交互</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 七牛云的配置需要前后端都配置才能生效</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 可以注册一个，有免费的额度可用</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 不使用这个的话，直接留空就可以，只会影响头像显示</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div></li></ol><h3 id="_4-使用-pm2-启动后台服务" tabindex="-1">4. 使用 pm2 启动后台服务 <a class="header-anchor" href="#_4-使用-pm2-启动后台服务" aria-label="Permalink to &quot;4. 使用 pm2 启动后台服务&quot;">​</a></h3><p>在启动后台服务之前，需要安装另外一个工具来管理 nodejs 的程序，因为后台是 nodejs 写的。</p><p>这个工具名叫 <strong>pm2</strong>，可以方便的管理 nodejs 后台服务。</p><blockquote><p>想了解它的更多使用方法请参阅： <a href="https://blog.csdn.net/KimBing/article/details/124249590" target="_blank" rel="noreferrer">pm2 使用教程： 管理你的 nodejs 后台项目</a></p></blockquote><ol><li>安装 <strong>pm2</strong>，执行<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">npm</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> i</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> -g</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> pm2</span></span></code></pre></div></li><li>启动服务，进入 <code>web根目录/portal/dist/bin</code> 目录<div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> ./portal.js</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> --name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> portal</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 指令释义</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> start</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # 使用 pm2 启动 nodejs 项目</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">./portal.js</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">      # 执行程序是 ./portal.js</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">--name</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> portal</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">    # 给它命名为 portal</span></span></code></pre></div>然后会看到一个表，表上显示着后台项目的名字和运行状态。过一会再执行一次下面指令查看运行情况， <img src="https://github.com/user-attachments/assets/ebacee53-51b1-4ff1-ac04-104f2aa69075" alt="pm2 status"><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">pm2</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> status</span></span></code></pre></div>如果看到状态栏显示 <strong>error</strong>，使用 <code>pm2 log</code> 的指令查看具体的错误信息排查问题所在。</li><li>完成之后，服务就正常运行在了你机器的 3000 端口，当你用浏览器访问 <code>你的ip:3000</code> 时，应该会看到下面的信息：<br> 比如我的 <code>kylebing.cn:3000</code><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{ </span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   &quot;status&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;success&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   &quot;message&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Portal API is running&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">   &quot;title&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Portal for Diary&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><img src="https://github.com/user-attachments/assets/be70e83d-3c84-40db-a4a9-780ef111cc7f" alt="服务器:3000"></li></ol><h3 id="_5-初始化系统" tabindex="-1">5. 初始化系统 <a class="header-anchor" href="#_5-初始化系统" aria-label="Permalink to &quot;5. 初始化系统&quot;">​</a></h3><blockquote><p>注意：初始化会清空 <code>diary</code> 数据库中的所有内容</p></blockquote><ol><li>删除后台目录中的 <code>DATABASE_LOCK</code> 这个文件。</li><li>直接访问 <code>你服务器的域名或IP:3000/init</code> 这个路径即可将数据库初始化，初始化数据库会自动创建一个名为 <code>diary</code> 的数据库。</li><li>初始化后，会自动在项目目录中新建一个名为 <code>DATABASE_LOCK</code> 的文件，之后将不能再执行这个接口，如果想再次初始化，需要先删除这个文件。</li></ol><blockquote><p><strong>建议定期自行备份数据库</strong></p></blockquote><h2 id="五、nginx-配置" tabindex="-1">五、nginx 配置 <a class="header-anchor" href="#五、nginx-配置" aria-label="Permalink to &quot;五、nginx 配置&quot;">​</a></h2><p>我们来梳理一下目前的目录和程序：</p><ul><li>后台服务运行在 <code>localhost:3000</code></li><li>前端运行在 <code>localhost/diary/</code></li></ul><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[ nginx 文档根目录 ]</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      │</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      ├──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> diary</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">   # 已放置好前端页面</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">      └──</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> portal</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  # 目前这个是缺失的 #####</span></span></code></pre></div><p>接下来要做的就是将 <code>localhost:3000</code> 的服务代理到 <code>/portal</code> 路径上去，这个就需要修改 <code>nginx</code> 配置文件。</p><p>如何找到 nginx 配置文件目录和配置文件 请自行豆包，不同系统的 nginx 配置文件放置位置可能会有不同，但配置文件的内容是一致的。</p><p>比如 <strong>ubuntu</strong> 的 <strong>nginx</strong> 配置文件目录就是在 <code>/etc/nginx/nginx.conf</code></p><p>根据这个格式添加对应内容。</p><div class="language-nginx vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">nginx</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">http_upgrade</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> $connection_upgrade {</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        default</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> upgrade;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">        &#39;&#39;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> close;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">upstream</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ws_server </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> localhost:9999;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    keepalive </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">upstream</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> portal_server </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> localhost:3000;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    keepalive </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2000</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        listen </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">80</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> default_server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        listen </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[::]:80 </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">default_server</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        root </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">/var/www/html;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 修改成你的 web 根目录路径</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        index </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">index.html index.htm index.nginx-debian.html;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        server_name </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">diary;  </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"># 这个自定义就好</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        </span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                ##</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        # Gzip Settings</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">        ##</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        gzip </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         gzip_vary </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">on</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         gzip_proxied </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">any;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         gzip_comp_level </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">6</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         gzip_buffers </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">16</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 8k</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         gzip_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">         gzip_types </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> / </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Access-Control-Allow-Origin * always;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">                try_files </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">$uri $uri/ </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">=404</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">                # rewrite ^(.*)$ https://$host$1; #将所有HTTP请求通过rewrite指令重定向到HTTPS。</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /portal/ </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            add_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Access-Control-Allow-Origin * always;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://portal_server/;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">            proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Host $host:$server_port;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">    </span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">       location</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> /ws </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_pass </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">http://ws_server;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_http_version </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1.1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Upgrade $http_upgrade;</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">          proxy_set_header </span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">Connection </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;upgrade&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        }</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>修改完成之后，重启 nginx 服务</p><div class="language-shell vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">shell</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">systemctl</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> restart</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> nginx</span></span></code></pre></div><p>如果出现错误，就根据提示排查下错误。</p><h2 id="六、其它" tabindex="-1">六、其它 <a class="header-anchor" href="#六、其它" aria-label="Permalink to &quot;六、其它&quot;">​</a></h2><h3 id="_1-邀请码" tabindex="-1">1. 邀请码 <a class="header-anchor" href="#_1-邀请码" aria-label="Permalink to &quot;1. 邀请码&quot;">​</a></h3><p>新用户注册需要邀请码，邀请码分为两种：</p><ul><li><strong>万能的</strong>：在后台系统的配置文件中配置</li><li><strong>一次性</strong>：一人一码</li></ul><ol><li>登入前端日记系统后，点开菜单，选择邀请码菜单，可以生成新的邀请码，点击邀请码就可以复制内容，分享给别人就可以了。 <blockquote><p>系统安装后，第一个注册的用户默认为管理员，即 <code>group_id</code> = <code>1</code><br> 用户默认注册后的 <code>group_id</code> 为 <code>2</code></p></blockquote></li><li>邀请码页面中显示的是都是未注册的码，复制后邀请码变为绿色，表示已被分享还未使用。</li><li>已使用的将会隐藏，不再显示在列表中。</li></ol><h3 id="_2-图片存储配置-选配" tabindex="-1">2. 图片存储配置 <code>[选配]</code> <a class="header-anchor" href="#_2-图片存储配置-选配" aria-label="Permalink to &quot;2. 图片存储配置 `[选配]`&quot;">​</a></h3><blockquote><p>如若不配置：只是不能显示用户头像而已<br> 头像文件是存储到 <a href="https://www.qiniu.com/" target="_blank" rel="noreferrer">七牛云</a> 上的，免费注册会有免费额度，够用。<br> 需要修改 <code>/config/projectConfig.json</code> 文件内容，改成你的七牛云配置。</p></blockquote><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;QiniuImgBaseURL&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 空间域名，最后面带 `/`</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;QiniuBucketName&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 七牛云对象存储空间的名称</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;QiniuStyleSuffix&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// 七牛云图片样式后缀，缩放图片尺寸</span></span></code></pre></div><h3 id="_3-和风天气配置-选配" tabindex="-1">3. 和风天气配置 <code>[选配]</code> <a class="header-anchor" href="#_3-和风天气配置-选配" aria-label="Permalink to &quot;3. 和风天气配置 `[选配]`&quot;">​</a></h3><blockquote><p>如若不配置：只是不能自动获取当地天气和温度而已<br> 用于从 <a href="https://www.qweather.com/" target="_blank" rel="noreferrer">和风天气</a> 中获取地域的天气和温度信息，也是在 <code>/config/projectConfig.json</code> 文件中</p></blockquote><div class="language-json vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">json</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 和风天气开发 key</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // 官网地址：https://console.qweather.com/</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">  // API文档：https://dev.qweather.com/docs/api/weather/</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">  &quot;HefengWeatherKey&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span></code></pre></div></div></div></main><footer class="VPDocFooter" data-v-e6f2a212 data-v-1bcd8184><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-1bcd8184><span class="visually-hidden" id="doc-footer-aria-label" data-v-1bcd8184>Pager</span><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link prev" href="/readme/diary/%E6%97%A5%E5%8E%86%E7%BF%BB%E9%98%85%E6%97%A5%E8%AE%B0.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Previous page</span><span class="title" data-v-1bcd8184>日历翻阅日记</span><!--]--></a></div><div class="pager" data-v-1bcd8184><a class="VPLink link pager-link next" href="/readme/diary/%E9%A1%B9%E7%9B%AE%E6%88%AA%E5%9B%BE.html" data-v-1bcd8184><!--[--><span class="desc" data-v-1bcd8184>Next page</span><span class="title" data-v-1bcd8184>项目截图</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-d8b57b2d data-v-566314d4><div class="container" data-v-566314d4><p class="message" data-v-566314d4>基于 MIT 许可发布</p><p class="copyright" data-v-566314d4>Copyright © 2024 我的文档</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"diary_不明显的一些功能.md\":\"Da2_tDX_\",\"diary_共享日记.md\":\"FMsVfnSX\",\"diary_列表说明.md\":\"DkS67KRe\",\"diary_待办列表.md\":\"D5wsl_Te\",\"diary_日历翻阅日记.md\":\"5frWzmqs\",\"diary_日记显示.md\":\"Fy6l0Nws\",\"diary_账单使用.md\":\"DZ6MVUzl\",\"diary_部署说明.md\":\"DsGsnEmT\",\"diary_银行卡列表.md\":\"D2oTvV5X\",\"diary_项目介绍.md\":\"CT92YDcE\",\"diary_项目截图.md\":\"CE0ycde5\",\"index.md\":\"Dv2xvK_p\",\"preset_api-examples.md\":\"ZlHnsZXt\",\"preset_markdown-examples.md\":\"B4L2LeXl\",\"readme.md\":\"CvxSbTBW\",\"v2ray_v2ray 客户端 linux.md\":\"N136oVxY\",\"v2ray_v2ray 客户端 macos.md\":\"H3WJGpfn\",\"v2ray_v2ray 客户端 windows.md\":\"DQKTYJ8O\",\"v2ray_v2ray 服务器配置.md\":\"CRSgwAjp\",\"v2ray_v2ray 谷歌浏览器插件使用.md\":\"CiKrsrIc\",\"wubidicteditor_tool.md\":\"DjSIn_i5\",\"wubidicteditor_五笔码表助手使用说明.md\":\"B2n1OKIk\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"zh-CN\",\"dir\":\"ltr\",\"title\":\"我的文档\",\"description\":\"HA!\",\"base\":\"/readme/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"siteTitle\":\"我的文档\",\"nav\":[{\"text\":\"主页\",\"link\":\"/\"},{\"text\":\"日记\",\"link\":\"/diary/项目介绍\"},{\"text\":\"V2ray\",\"link\":\"/v2ray/v2ray 客户端 Linux\"}],\"sidebar\":[{\"text\":\"1. 标题日记\",\"items\":[{\"text\":\"项目介绍\",\"link\":\"/diary/项目介绍\"},{\"text\":\"账单使用\",\"link\":\"/diary/账单使用\"},{\"text\":\"共享日记\",\"link\":\"/diary/共享日记\"},{\"text\":\"不明显的一些功能\",\"link\":\"/diary/不明显的一些功能\"},{\"text\":\"日记显示\",\"link\":\"/diary/日记显示\"},{\"text\":\"待办列表\",\"link\":\"/diary/待办列表\"},{\"text\":\"银行卡列表\",\"link\":\"/diary/银行卡列表\"},{\"text\":\"日历翻阅日记\",\"link\":\"/diary/日历翻阅日记\"},{\"text\":\"部署说明\",\"link\":\"/diary/部署说明\"},{\"text\":\"项目截图\",\"link\":\"/diary/项目截图\"}]},{\"text\":\"2. v2ray\",\"items\":[{\"text\":\"v2ray 客户端 Linux\",\"link\":\"/v2ray/v2ray 客户端 Linux\"},{\"text\":\"v2ray 客户端 macOS\",\"link\":\"/v2ray/v2ray 客户端 macOS\"},{\"text\":\"v2ray 客户端 Windows\",\"link\":\"/v2ray/v2ray 客户端 Windows\"},{\"text\":\"v2ray 服务器配置\",\"link\":\"/v2ray/v2ray 服务器配置\"},{\"text\":\"v2ray 谷歌浏览器插件使用\",\"link\":\"/v2ray/v2ray 谷歌浏览器插件使用\"}]},{\"text\":\"3. 五笔码表助手\",\"items\":[{\"text\":\"五笔码表助手\",\"link\":\"/wubiDictEditor/五笔码表助手使用说明\"},{\"text\":\"码表处理工具\",\"link\":\"/wubiDictEditor/tool\"}]},{\"text\":\"〇、预设\",\"items\":[{\"text\":\"Markdown 例子\",\"link\":\"/preset/markdown-examples\"},{\"text\":\"API 例子\",\"link\":\"/preset/api-examples\"}]}],\"socialLinks\":[{\"icon\":\"github\",\"link\":\"https://github.com/vuejs/vitepress\"}],\"footer\":{\"message\":\"基于 MIT 许可发布\",\"copyright\":\"Copyright © 2024 我的文档\"},\"search\":{\"provider\":\"local\",\"options\":{\"locales\":{\"zh\":{\"translations\":{\"button\":{\"buttonText\":\"搜索文档\",\"buttonAriaLabel\":\"搜索文档\"},\"modal\":{\"noResultsText\":\"无法找到相关结果\",\"resetButtonTitle\":\"清除查询条件\",\"footer\":{\"selectText\":\"选择\",\"navigateText\":\"切换\",\"closeText\":\"关闭\"}}}}}}}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>